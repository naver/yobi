
@(message: String, project: Project, histories: List[models.History] )

@import utils.JodaDateUtil._
@import utils.TemplateHelper._
@import models.enumeration._

@main(message, project, utils.MenuType.PROJECT_HOME) {
<div class="page">
	@prjmenu(project, utils.MenuType.PROJECT_HOME, "")

    <div class="input-prepend">
        <span class="add-on">@project.vcs</span>
        <input type="text" value="@CodeApp.getURL(project.owner, project.name)" readonly="true"
            style="cursor: auto; background-color:#ffffff">
        <div class="btn-group pull-right">
            <a href="@routes.IssueApp.issues(project.owner, project.name, State.OPEN.state)" class="btn">
                @Issue.countIssues(project.id, State.OPEN) @Messages("issue.state.open")
            </a>
            <button class="btn" disabled="true">@Messages("menu.issue")</button>
            <a href="@routes.IssueApp.issues(project.owner, project.name, State.CLOSED.state)" class="btn">
                @Issue.countIssues(project.id, State.CLOSED) @Messages("issue.state.closed")
            </a>
        </div>
    </div>

    <div class="bubble-wrap dark-gray project-home">
        <div class="inner logo">
            <div class="logo-wrap">
              <img src="@defining(Attachment.findByContainer(project.asResource)) @{ files =>
              if (files.size > 0) "/files/" + files.head.id
              else routes.Assets.at("images/bg-default-project.jpg")}"/>
            </div>
        </div>
        <div class="inner project-info">
            <header>
                <h3>@Messages("project.info")</h3>
                <!--<div class="project-status">
                    <i class="ico ico-like"></i>
                    <span class="num">100</span>
                    <span class="sp">|</span>
                    <i class="ico ico-activity high"></i>
                </div>-->
            </header>
            <ul class="infos">
                <li class="info">
                    <strong>@Messages("project.license") :</strong> GPL v2
                </li>
                <li class="info">
                    <strong>@Messages("project.tags") :</strong>
                    @for(tag <- project.tags) {
                    <span class="label">@tag.name</span>
                    }
                </li>
                <li class="info">
                    <strong>@Messages("project.codeLanguage") :</strong> Java, JavaScript
                </li>
                <li class="info">
                    <strong>@Messages("project.vcs") :</strong> @project.vcs
                </li>
            </ul>
        </div>
        <div class="inner member-info">
            <header>
                <h3>@Messages("project.members")</h3>
            </header>
            <div class="member-wrap">
                <ul class="project-members">
                    @for(member <- User.findUsersByProject(project.id)){
                    <li class="member">
                    	<a href="@routes.UserApp.userInfo(member.loginId)" class="avatar-wrap img-rounded pull-left small">
                        	<img src="@member.avatarUrl" alt="@member.loginId" width="24" height="24">
                        </a>
                        <a href="@routes.UserApp.userInfo(member.loginId)" class="name">
                        	<strong>@member.loginId (@member.name)</strong>
                        </a>
                    </li>
                    }
                </ul>
            </div>
        </div>
    </div>

    @if(histories.size > 0) {
        <table class="table table-hover">
            <tbody>
                @for(history <- histories.iterator()) {
                    <tr>
                        <td>@agoString(ago(history.getWhen()))</td>
                        <td><a href="@history.getUserPageUrl()">@history.getWho()</a></td>
                        <td>@history.getWhat()</td>
                        <td><a href="@history.getUrl()">@history.getHow()</a></td>
                    </tr>
                }
            </tbody>
        </table>
    }

    <div class="bubble-wrap dark-gray readme">
        @if(project.readme == null) {
            <p class="default">
                @Messages("project.readme")
            </p>
        } else {
        <div class="readme-wrap">
           <header><i class="ico ico-readme-book"></i><strong>README.md</strong></header>
           <div class="readme-body" markdown="true">
               @project.readme
           </div>
        </div>
        }
	    @markdown()
    </div>
</div>
}